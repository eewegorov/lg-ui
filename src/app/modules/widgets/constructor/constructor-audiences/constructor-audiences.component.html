<div class="widgets-settings-container">
  <!-- Audiences list -->
  <div id="audiences-list">
    <h1>{{ 'widgetsList.editor.audiences.title' | translate }}</h1>
    <div class="f-4 audience-tooolbar-desc" style="margin-top: 30px;">{{ 'widgetsList.editor.audiences.disc' | translate }}</div>
    <div class="toolbar-content no-padding padding-top-30">
      <div class="row btnpanel">
        <div class="audience-tooolbar-switcher">
          <ui-switch
            [checked]="widget.audiencesEnabled"
            (change)="onChangePayment"
            class="margined-top-5 margined-right-10 floated-left"
          ></ui-switch><h3 class="f-5 margined-top-5">{{ 'widgetsList.editor.audiences.enabled' | translate }}<span
          class="label label-warning tariff-info biggest">окупаемый</span></h3>
        </div>
      </div>
    </div>
  </div>
  <!-- End Audiences list -->

  <!-- Audience editor -->
  <div id="audiences-item">
    <!-- Audience editor core -->
    <div class="row row-nomargined margined-bottom-15">
      <div class="col-lg-8" id="rules-containers">
        <label class="control-label">{{ 'audience.settings' | translate }}</label>
        <div
          *ngIf="audience.groups.length == 0"
          class="rule-container rule-def"
          appDropContainer
          [audience]="audience"
          [type]="'AND'"
        >
          <div class="rule-droppable">
            <h4>{{ 'audience.rule.droppable' | translate }}</h4>
          </div>
        </div>
        <div *ngFor="let group of audience.groups; index as i">
          <div class="rule-groups-text" *ngIf="i !== 0">{{ 'audience.rule.logic.and' | translate }}</div>
          <div *ngFor="let item of group.items; index as j">
            <div class="rule-block">
              <div class="rule-header">
                <i class="pe-7s-close-circle" (click)="removeItem(group.id, j)"></i>
              </div>
              <div class="rule-body" [ngSwitch]="item.type">
                <app-rule-devices   *ngSwitchCase="'devices'" [item]="item" [group]="group"></app-rule-devices>
                <app-rule-refer     *ngSwitchCase="'refer'"   [item]="item" [group]="group"></app-rule-refer>
                <app-rule-social    *ngSwitchCase="'social'"  [item]="item" [group]="group"></app-rule-social>
                <app-rule-type      *ngSwitchCase="'type'"    [item]="item" [group]="group"></app-rule-type>
                <app-rule-url       *ngSwitchCase="'url'"     [item]="item" [group]="group"></app-rule-url>
                <app-rule-visit     *ngSwitchCase="'visit'"   [item]="item" [group]="group"></app-rule-visit>
                <app-rule-visit-no  *ngSwitchCase="'visitno'" [item]="item" [group]="group"></app-rule-visit-no>
                <h1 *ngSwitchDefault>ERROR!</h1>
              </div>
            </div>
            <div class="rule-groups-text">{{ 'audience.rule.logic.or' | translate }}</div>
          </div>

          <div
            class="rule-container margined-bottom-15"
            appDropContainer
            [audience]="audience"
            [type]="'OR'"
            [index]="i"
          >
            <div class="rule-droppable-or">
              <h4>{{ 'audience.rule.ordroppable' | translate }}</h4>
            </div>
          </div>
          <div *ngIf="i === audience.groups.length - 1">
            <div class="rule-groups-text rule-groups-text-ok">{{ 'audience.rule.logic.and' | translate }}</div>
            <div
              class="rule-container rule-container-ok"
              appDropContainer
              [audience]="audience"
              [type]="'AND'"
            >
              <div class="rule-droppable-and">
                <h4>{{ 'audience.rule.anddroppable' | translate }}</h4>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-4 rules-templates-list">
        <label class="control-label">{{ 'audience.rules' | translate }}</label>
        <div>
          <div name="code">refer</div>
          <div name="name">{{ 'audience.rule.refer' | translate }}</div>
          <div name="description">{{ 'audience.rule.refer.desc' | translate }}</div>
        </div>
        <div>
          <div name="code">type</div>
          <div name="name">{{ 'audience.rule.type' | translate }}</div>
          <div name="description">{{ 'audience.rule.type.desc' | translate }}</div>
        </div>
        <div>
          <div name="code">url</div>
          <div name="name">{{ 'audience.rule.url' | translate }}</div>
          <div name="description">{{ 'audience.rule.url.desc' | translate }}</div>
        </div>
        <div>
          <div name="code">visit</div>
          <div name="name">{{ 'audience.rule.visit' | translate }}</div>
          <div name="description">{{ 'audience.rule.visit.desc' | translate }}</div>
        </div>
        <div>
          <div name="code">visitno</div>
          <div name="name">{{ 'audience.rule.visitno' | translate }}</div>
          <div name="description">{{ 'audience.rule.visitno.desc' | translate }}</div>
        </div>
        <div>
          <div name="code">devices</div>
          <div name="name">{{ 'audience.rule.devices' | translate }}</div>
          <div name="description">{{ 'audience.rule.devices.desc' | translate }}</div>
        </div>
        <div>
          <div name="code">social</div>
          <div name="name">{{ 'audience.rule.social' | translate }}</div>
          <div name="description">{{ 'audience.rule.social.desc' | translate }}</div>
        </div>
      </div>
    </div>
  </div>
  <!-- End Audience editor -->
</div>
