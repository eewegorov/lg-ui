<div class="widgets-settings-container" id="widgetStyle">
  <div *ngIf="widget.guiprops" class="row widget-style-wrapper">
    <div class="col-lg-3 widget-style-menu">
      <div class="elements-selector">
        <div *ngIf="widget.guiprops.elementsList" class="elements-selector-top">
          <div
            (click)="setCurrentElement('settings')"
            [class.active]="currentElement === 'settings'"
            [class.error]="isElementHasError('settings', 0) && showErrors"
            class="element"
          >
            <div class="before">
              <div class="square"></div>
            </div>
            <div class="settings-icon-small icon"></div>
            <span>Настройки</span>
            <div class="after fade-in">
              <div class="square"></div>
            </div>
          </div>
          <div
            (click)="setCurrentElement(element.name + (element.counter ? ('#' + element.counter) : '')); currentIndex = i"
            *ngFor="let element of widget.guiprops.elementsList; index as i"
            [class.active]="currentElement === element.name + (element.counter ? ('#' + element.counter) : '')"
            [class.error]="isElementHasError(element.name, element.counter) && showErrors"
            class="element"
          >
            <div class="before fade-in">
              <div class="square"></div>
            </div>
            <div [class]="element.name + '-icon-small icon'"></div>
            <span>{{ getElementByName(element.name) }}</span> <span
            *ngIf="element.counter"> #{{ element.counter }}</span>
            <div class="after fade-in">
              <div class="square"></div>
            </div>
          </div>
          <div
            (click)="setCurrentElement('add-element')"
            [class.active]="currentElement === 'add-element'"
            class="element"
          >
            <div class="before fade-in">
              <div class="square"></div>
            </div>
            <div class="add-icon-small icon"></div>
            <span class="add-element">Добавить элемент</span>
            <div class="after fade-in">
              <div class="square"></div>
            </div>
          </div>
        </div>

        <!--<div class="device-selector">
          <div
            class="element"
            [class.active]="currentDevice === 'desktop'"
            (click)="currentDevice = 'desktop'"
          >
            <div class="desktop-icon-small icon"></div>
          </div>
          <div
            class="element"
            [class.active]="currentDevice === 'mobile'"
            (click)="currentDevice = 'mobile'"
          >
            <div class="mobile-icon-small icon"></div>
          </div>
        </div>-->
      </div>
      <div [@slide]="!extendedElement ? 'right' : 'left'"  class="elements">
        <div class="elements-default">
          <div class="menu-fixed">
            <h4 class="panel-title" id="menu-select">
              <ng-container *ngIf="currentElement === 'settings'">
                Настройки виджета
              </ng-container>
              <ng-container *ngIf="currentElement === 'add-element'">
                Добавить элемент
              </ng-container>
              <ng-container *ngIf="currentElement !== 'settings' && currentElement !== 'add-element'">
                {{ getElementByName(currentElement.split('#')[0]) + ' ' }}
                <ng-container *ngIf="currentElement.split('#')[1]">
                  #{{ currentElement.split('#')[1] }}
                </ng-container>
                <a
                  (click)="removeCurrentElement(currentElement, currentIndex)"
                  href="javascript:void(0);"
                >
                  <i class="remove-item" data-placement="bottom"
                     data-toggle="tooltip"
                     title="{{ 'widgetsList.editor.remove' | translate }}"></i>
                </a>
              </ng-container>
            </h4>
          </div>
          <div aria-multiselectable="true" class="panel-group" id="accordion" role="tablist">
            <div class="hide" id="disabledFuncAct"></div>
            <div id="accordionIn">
              <div [hidden]="currentElement !== 'settings'" class="panel panel-default" id="0">
                <div aria-labelledby="headingFour" class="panel-collapse collapse show" id="collapseFour"
                     role="tabpanel">
                  <div class="panel-body">
                    <div class="border-item mb-4" [class.pb-0]="widgetType === 'containerized'">
                      <div class="d-flex row-subitem row-subitem-padding mb-3">
                        <h3 class="marg-minus-bord-des">Расположение на странице</h3>
                      </div>

                      <div *ngIf="widgetType === 'containerized'" class="row row-subitem row-static-widget-wrapper">
                        <div class="col-sm-12 row-subitem-padding mt-2">
                          <label class="control-label">Код установки виджета:</label>
                          <input
                            [(ngModel)]="staticWidgetInstallCode"
                            appSelectOnClick
                            class="form-control not-readonly-hand"
                            name="name"
                            readonly
                            type="text"
                          />
                        </div>
                      </div>
                      <div
                        *ngIf="widgetType === 'containerized'"
                        class="row-subitem row-subitem-padding mb-1 mt-3 widget-small-text"
                      >
                        <span>
                          Установите этот код в месте на странице сайта, где вы хотите разместить виджет. Обратите
                          внимание, что для всех виджетов в одном контейнере используется единый код установки. И если
                          этот код уже установлен, то повторная его установка не требуется.
                        </span>

                        <h3 class="mt-4">Выравнивание</h3>
                      </div>

                      <div class="d-flex row-subitem row-subitem-padding" [style.margin-top]="widgetType === 'containerized' ? '-15px' : ''">
                        <app-position-control
                          (changePosition)="changePosition($event)"
                          *ngIf="widgetType === 'popup' || widgetType === 'optindot' || widgetType === 'label_widget' || widgetType === 'containerized'"
                          [currentPosition]="widgetType === 'popup' ? widget.guiprops.popupMain?.place : widgetType === 'optindot' ? widget.guiprops.dhVisual?.place : widgetType === 'label_widget' ? widget.guiprops.labelMain?.place : widget.guiprops.staticMain?.position"
                          [positions]="widgetType === 'popup' ? placePopup : widgetType === 'optindot' ? placeDh : widgetType === 'label_widget' ? placeLabel : staticWidgetAlign"
                        ></app-position-control>
                      </div>
                    </div>

                    <ng-container *ngIf="widgetType === 'popup'">
                      <div class="border-item">
                        <div class="d-flex justify-content-between w-100 row-subitem-padding pt-1">
                          <label class="control-label switcher-label-xs control-label-des">
                            Затемнять фон страницы маской
                          </label>
                          <ui-switch
                            [(ngModel)]="widget.guiprops.popupMain.shadow.enable"
                            size="small"
                          ></ui-switch>
                        </div>
                        <div *ngIf="widget.guiprops.popupMain?.shadow.enable">
                          <div class="row justify-content-between mt-3 mb-3">
                            <label class="control-label">Цвет маски</label>
                            <div class="text-right">
                              <input
                                [(colorPicker)]="widget.guiprops['popupMain'].shadow.color"
                                [cpAlphaChannel]="'disabled'"
                                [cpOutputFormat]="'hex'"
                                [style.background]="widget.guiprops['popupMain'].shadow.color"
                                class="color-picker-control"
                                cpPosition="left"
                                readonly
                              />
                              <input
                                [(ngModel)]="widget.guiprops['popupMain'].shadow.color"
                                class="picker-input color"
                              />
                            </div>
                          </div>

                          <div class="row justify-content-between mt-3">
                            <label class="control-label">Прозрачность</label>
                            <div class="row text-right side-ui-sm">
                              <ngx-slider
                                [(value)]="widget.guiprops['popupMain'].shadow.opacityColor"
                                [options]="optionsOpacity"
                              ></ngx-slider>
                              <input
                                [(ngModel)]="widget.guiprops['popupMain'].shadow.opacityColor"
                                class="picker-input slider"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-container>

                    <ng-container *ngIf="widgetType === 'optindot'">
                      <div class="border-item">
                        <div class="d-flex row-subitem row-subitem-padding mt-4">
                          <h3>Дизайн точки</h3>
                        </div>
                        <div class="flex-column row-subitem pt-1">
                          <div class="row justify-content-between mt-3 mb-3">
                            <label class="control-label">Основной цвет</label>
                            <div class="text-right">
                              <input
                                [(colorPicker)]="widget.guiprops['dhVisual'].colorMain"
                                [cpAlphaChannel]="'disabled'"
                                [cpOutputFormat]="'hex'"
                                [style.background]="widget.guiprops['dhVisual'].colorMain"
                                class="color-picker-control"
                                cpPosition="left"
                                readonly
                              />
                              <input
                                [(ngModel)]="widget.guiprops['dhVisual'].colorMain"
                                class="picker-input color"
                              />
                            </div>
                          </div>
                          <div class="row justify-content-between mt-3 mb-3">
                            <label class="control-label">Цвет заливки</label>
                            <div class="text-right">
                              <input
                                [(colorPicker)]="widget.guiprops['dhVisual'].colorBg"
                                [cpAlphaChannel]="'disabled'"
                                [cpOutputFormat]="'hex'"
                                [style.background]="widget.guiprops['dhVisual'].colorBg"
                                class="color-picker-control"
                                cpPosition="left"
                                readonly
                              />
                              <input
                                [(ngModel)]="widget.guiprops['dhVisual'].colorBg"
                                class="picker-input color"
                              />
                            </div>
                          </div>
                        </div>
                        <div class="row row-subitem mt-3">
                          <div class="col-sm-12 row-subitem-padding">
                            <h4 class="h4-text-tit">Добавить иконку или изображение:</h4>
                          </div>
                          <div class="clearfix"></div>
                          <div class="flex-bl-for-radio-group mt-1">
                            <div class="row-subitem-padding radio-group-item mr-4">
                              <div class="form-group widget-selector">
                                <label>
                                  <input
                                    [(ngModel)]="widget.guiprops.dhVisual.iconOrImage"
                                    class="radio radio-info radio-inline"
                                    name="dhVisual"
                                    type="radio" value="useIcon"
                                  >
                                  Иконку
                                </label>
                              </div>
                            </div>
                            <div class="row-subitem-padding radio-group-item">
                              <div class="form-group widget-selector">
                                <label class="non-bold">
                                  <input
                                    [(ngModel)]="widget.guiprops.dhVisual.iconOrImage"
                                    class="radio radio-info radio-inline"
                                    name="dhVisual"
                                    type="radio" value="useImg"
                                  >
                                  Изображение
                                </label>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div [hidden]="widget.guiprops.dhVisual?.iconOrImage !== 'useIcon'"
                             class="row row-subitem align-items-center">
                          <div class="row-subitem-padding mr-2 mt-1">
                            <label class="control-label">{{ 'widgets.formExt.button.icon.label' | translate }}:</label>
                          </div>
                          <div class="icp-icon row-subitem-padding">
                            <div class="btn-group">
                              <button
                                *ngIf="!widget.guiprops.dhVisual.selectedIcon"
                                class="btn btn-primary"
                                type="button"
                              >
                                <i [class]="'lgiconfont-' + widget.guiprops.dhVisual.selectIcon"></i>
                              </button>
                              <button
                                *ngIf="widget.guiprops.dhVisual.selectedIcon"
                                class="btn btn-primary iconpicker-component"
                                type="button"
                              >
                                <i
                                  [class]="widget.guiprops.dhVisual.selectedIcon.includes('fa ') ? widget.guiprops.dhVisual.selectedIcon : 'lgiconfont-' + widget.guiprops.dhVisual.selectIcon"
                                ></i>
                              </button>
                              <input
                                (iconPickerSelect)="onDotIconPickerSelect($event)"
                                [iconPicker]="widget.guiprops.dhVisual.selectIcon"
                                [ipIconPack]="['fa']"
                                class="icp btn btn-primary dropdown-toggle"
                                id="icon-picker-dot"
                                ipPosition="top"
                              />
                              <span class="caret"></span>
                            </div>
                          </div>
                        </div>
                        <div *ngIf="widget.guiprops.dhVisual?.iconOrImage === 'useImg'" class="mt-1">
                          <button
                            (click)="listFile('dotIcon')"
                            *ngIf="isDefault(widget.guiprops.dhVisual.url)"
                            class="widget-download-img"
                          >
                            <img alt="Загрузить изображение" src="assets/images/widgets/upload.svg"/> Загрузить
                            изображение
                          </button>

                          <div *ngIf="!isDefault(widget.guiprops.dhVisual.url)" class="image-container">
                            <img [src]="widget.guiprops.dhVisual.url" alt="image"/>
                            <div class="d-flex justify-content-between align-items-center">
                              <p>{{ widget.guiprops.dhVisual.url.split('/').pop() }}</p>
                              <div class="remove-sub-item">
                                <button (click)="removeImage(true)" class="delete-element-button">&times;</button>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row row-subitem mt-3">
                          <div class="d-flex justify-content-between w-100 row-subitem-padding pt-1">
                            <label class="control-label switcher-label-xs control-label-des">Призыв к действию</label>
                            <ui-switch
                              [(ngModel)]="widget.guiprops.dhVisual.enable"
                              size="small"
                            ></ui-switch>
                          </div>
                        </div>
                        <div *ngIf="widget.guiprops.dhVisual?.enable">
                          <div class="row-subitem mt-2 pt-1">
                            <input [(ngModel)]="widget.guiprops['dhVisual'].title" class="form-control" type="text">
                            <span class="small">Например: Хотите, мы вам перезвоним?</span>
                          </div>
                        </div>
                        <div class="row-subitem row-subitem-padding pt-1 mt-3">
                          <div class="form-check">
                            <label class="form-check-label">
                              <input
                                [(ngModel)]="widget.guiprops.dhVisual.enableBlink"
                                class="form-check-input"
                                type="checkbox"
                              />
                              <span class="checkmark"></span>
                            </label>
                            <span class="form-check-text f-3">Убрать мерцание точки захвата</span>
                          </div>
                        </div>
                      </div>
                    </ng-container>

                    <ng-container *ngIf="widgetType === 'label_widget'">
                      <div class="border-item">
                        <div class="d-flex row-subitem row-subitem-padding mt-4">
                          <h3>Дизайн ярлычка</h3>
                        </div>
                        <div class="row-subitem widget-name-block-rel mt-3">
                          <label class="control-label">Текст</label>
                          <input
                            [(ngModel)]="widget.guiprops.labelMain.text"
                            class="form-control mt-1"
                            id="widgetNameInp"
                            placeholder="Введите название виджета"
                            type="text"
                          />
                          <span class="small">Например: Оставьте нам сообщение!</span>
                        </div>

                        <label class="control-label mt-3">Шрифт</label>

                        <div class="row-subitem row-subitem-padding mt-1">
                          <input id="fontPickerLabelMain" type="text">
                        </div>

                        <div class="d-flex align-items-center justify-content-between mt-2">
                          <label class="control-label">Размер</label>
                          <div class="row align-items-center">
                            <div class="form-control form-control-font">
                              <input
                                [(ngModel)]="widget.guiprops['labelMain'].fontSize"
                                type="number"
                              />
                              <label>px</label>
                            </div>
                          </div>
                        </div>

                        <div class="d-flex justify-content-between mt-3">
                          <label class="control-label">Цвет ярлычка</label>
                          <div class="text-right">
                            <input
                              [(colorPicker)]="widget.guiprops['labelMain'].colorLabel"
                              [cpAlphaChannel]="'disabled'"
                              [cpOutputFormat]="'hex'"
                              [style.background]="widget.guiprops['labelMain'].colorLabel"
                              class="color-picker-control"
                              cpPosition="left"
                              readonly
                            />
                            <input
                              [(ngModel)]="widget.guiprops['labelMain'].colorLabel"
                              class="picker-input color"
                            />
                          </div>
                        </div>

                        <div class="d-flex justify-content-between mt-3">
                          <label class="control-label">Цвет текста</label>
                          <div class="text-right">
                            <input
                              [(colorPicker)]="widget.guiprops['labelMain'].colorText"
                              [cpAlphaChannel]="'disabled'"
                              [cpOutputFormat]="'hex'"
                              [style.background]="widget.guiprops['labelMain'].colorText"
                              class="color-picker-control"
                              cpPosition="left"
                              readonly
                            />
                            <input
                              [(ngModel)]="widget.guiprops['labelMain'].colorText"
                              class="picker-input color"
                            />
                          </div>
                        </div>

                        <div class="d-flex justify-content-between mt-3">
                          <label class="control-label">Прозрачность</label>
                          <div class="d-flex text-right side-ui-sm">
                            <ngx-slider [(value)]="widget.guiprops['labelMain'].opacityBgLabel"
                                        [options]="optionsOpacity"></ngx-slider>
                            <input
                              [(ngModel)]="widget.guiprops['labelMain'].opacityBgLabel"
                              class="picker-input slider"
                            />
                          </div>
                        </div>

                        <div class="d-flex justify-content-between mt-3">
                          <label class="control-label">Скругление углов</label>
                          <div class="d-flex text-right side-ui-sm">
                            <ngx-slider [(value)]="widget.guiprops['labelMain'].borderRadiusLabel"
                                        [options]="optionsRound"></ngx-slider>
                            <input
                              [(ngModel)]="widget.guiprops['labelMain'].borderRadiusLabel"
                              class="picker-input slider"
                            />
                          </div>
                        </div>

                        <div class="row-subitem mt-3">
                          <h4 class="h4-text-tit control-label-des">Добавить иконку или изображение на ярлычок</h4>

                          <div class="flex-bl-for-radio-group mt-2 pt-1">
                            <div class="row-subitem-padding radio-group-item mr-3">
                              <div class="form-group widget-selector">
                                <label>
                                  <input
                                    [(ngModel)]="widget.guiprops.labelMain.iconOrImage"
                                    class="radio radio-info radio-inline"
                                    name="label"
                                    type="radio"
                                    value="useIcon"
                                  />
                                  Иконку
                                </label>
                              </div>
                            </div>
                            <div class="row-subitem-padding radio-group-item mr-3">
                              <div class="form-group widget-selector">
                                <label>
                                  <input
                                    [(ngModel)]="widget.guiprops.labelMain.iconOrImage"
                                    class="radio radio-info radio-inline"
                                    name="label"
                                    type="radio"
                                    value="useImg"
                                  />
                                  Изображение
                                </label>
                              </div>
                            </div>
                            <div class="row-subitem-padding">
                              <div class="form-group widget-selector">
                                <label>
                                  <input
                                    [(ngModel)]="widget.guiprops.labelMain.iconOrImage"
                                    class="radio radio-info radio-inline"
                                    name="label"
                                    type="radio"
                                    value="useNone"
                                  />
                                  Не добавлять
                                </label>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div [hidden]="widget.guiprops.labelMain.iconOrImage !== 'useIcon'">
                          <div class="d-flex justify-content-between mt-2">
                            <label class="control-label">Цвет иконки</label>
                            <div class="text-right">
                              <input
                                [(colorPicker)]="widget.guiprops['labelMain'].icon.color"
                                [cpAlphaChannel]="'disabled'"
                                [cpOutputFormat]="'hex'"
                                [style.background]="widget.guiprops['labelMain'].icon.color"
                                class="color-picker-control"
                                cpPosition="left"
                                readonly
                              />
                              <input
                                [(ngModel)]="widget.guiprops['labelMain'].icon.color"
                                class="picker-input color"
                              />
                            </div>
                          </div>

                          <div class="d-flex row-subitem align-items-center mt-2">
                            <label class="control-label mr-2">{{ 'widgets.formExt.button.icon.label' | translate }}:</label>

                            <div class="icp-icon row-subitem-padding">
                              <div class="btn-group">
                                <button
                                  *ngIf="!widget.guiprops.labelMain.icon.selectedIcon"
                                  class="btn btn-primary"
                                  type="button"
                                >
                                  <i [class]="'lgiconfont-' + widget.guiprops.labelMain.icon.selectIcon"></i>
                                </button>
                                <button
                                  *ngIf="widget.guiprops.labelMain.icon.selectedIcon"
                                  class="btn btn-primary iconpicker-component"
                                  type="button"
                                >
                                  <i
                                    [class]="widget.guiprops.labelMain.icon.selectedIcon.includes('fa ') ? widget.guiprops.labelMain.icon.selectedIcon : 'lgiconfont-' + widget.guiprops.labelMain.icon.selectIcon"
                                  ></i>
                                </button>
                                <input
                                  (iconPickerSelect)="onLabelIconPickerSelect($event)"
                                  [iconPicker]="widget.guiprops.labelMain.icon.selectIcon"
                                  [ipIconPack]="['fa']"
                                  class="icp btn btn-primary dropdown-toggle"
                                  id="icon-picker-label"
                                  ipPosition="top"
                                />
                                <span class="caret"></span>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div *ngIf="widget.guiprops.labelMain.iconOrImage === 'useImg'" class="mt-1">
                          <button
                            (click)="listFile('labelIcon')"
                            *ngIf="isDefault(widget.guiprops.labelMain.url)"
                            class="widget-download-img"
                          >
                            <img alt="Загрузить изображение" src="assets/images/widgets/upload.svg"/> Загрузить
                            изображение
                          </button>

                          <div *ngIf="!isDefault(widget.guiprops.labelMain.url)" class="image-container">
                            <img [src]="widget.guiprops.labelMain.url" alt="image"/>
                            <div class="d-flex justify-content-between align-items-center">
                              <p>{{ widget.guiprops.labelMain.url.split('/').pop() }}</p>
                              <div class="remove-sub-item">
                                <button (click)="removeImage(false)" class="delete-element-button">&times;</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-container>

                    <ng-container *ngIf="widgetType === 'containerized'">
                      <h3>Настройка дизайна виджета</h3>
                    </ng-container>

                    <app-visual-element
                      (getVideo)="getVideoId($event)"
                      (listFileItem)="listFile($event)"
                      [bgPositionTypesList]="bgPositionTypesList"
                      [imageItemsAlign]="imageItemsAlign"
                      [imageItemsType]="imageItemsType"
                      [maskTypeList]="maskTypeList"
                      [placeImg]="placeImg"
                      [tilesList]="tilesList"
                      [vertOrientDh]="vertOrientDh"
                      [widget]="widget"
                      [widgwidthBtn]="widgwidthBtn"
                    ></app-visual-element>
                    <app-redirect-element [widget]="widget" [showErrors]="showErrors"></app-redirect-element>
                  </div>
                </div>
              </div>

              <div class="panel panel-default" id="1">
                <div aria-labelledby="headingTwo" class="panel-collapse collapse show" id="collapseTwo" role="tabpanel">
                  <div *ngIf="widget.guiprops && widget.guiprops.elementsList" class="panel-body mb-5">
                    <div *ngFor="let item of widget.guiprops.elementsList; index as i" [id]="'elemScrN' + i">
                      <div
                        *ngIf="item.name === 'button-element'"
                        [hidden]="currentElement !== 'button-element' + (item.counter ? ('#' + item.counter) : '')"
                      >
                        <app-button-element
                          (setBtn)="setBtnStyle($event.type, $event.item)"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [visualInputForm]="visualInputForm"
                          [widget]="widget"
                          [widthBtn]="widthBtn"
                        ></app-button-element>
                      </div>

                      <div *ngIf="item.name === 'closelink-element'"
                           [hidden]="currentElement !== 'closelink-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-closelink-element
                          (setBtn)="setBtnStyle($event.type, $event.item)"
                          [coupons]="coupons"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [placePopup]="placePopup"
                          [widget]="widget"
                          [widthBtn]="widthBtn"
                        ></app-closelink-element>
                      </div>

                      <div *ngIf="item.name === 'coupon-element'"
                           [hidden]="currentElement !== 'coupon-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-coupon-element
                          [coupons]="coupons"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [item]="item"
                          [widthBtn]="widthBtn"
                        ></app-coupon-element>
                      </div>

                      <div *ngIf="item.name === 'form-element'"
                           [hidden]="currentElement !== 'form-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-form-element
                          (setBtn)="setBtnStyle($event.type, $event.item)"
                          [coupons]="coupons"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [orientInputForm]="orientInputForm"
                          [placePopup]="placePopup"
                          [visualInputForm]="visualInputForm"
                          [widget]="widget"
                          [widthBtn]="widthBtn"
                          [widthHrType]="widthHrType"
                        ></app-form-element>
                      </div>

                      <div *ngIf="item.name === 'iframe-element'"
                           [hidden]="currentElement !== 'iframe-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-iframe-element
                          (buildIframeElement)="buildIframeElement($event, i, true)"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [modelName]="item"
                          [widgwidthBtn]="widgwidthBtn"
                          [widthHrType]="widthHrType"
                        ></app-iframe-element>
                      </div>

                      <div *ngIf="item.name === 'image-element'"
                           [hidden]="currentElement !== 'image-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-image-element
                          (listFileItem)="listFile($event.place, $event.item)"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [modelName]="item"
                          [widthHrType]="widthHrType"
                        ></app-image-element>
                      </div>

                      <div *ngIf="item.name === 'padding-element'"
                           [hidden]="currentElement !== 'padding-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-padding-element
                          [index]="i"
                          [modelName]="item"
                        ></app-padding-element>
                      </div>

                      <div *ngIf="item.name === 'social-element'"
                           [hidden]="currentElement !== 'social-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-social-element
                          [coupons]="coupons"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [placePopup]="placePopup"
                          [widget]="widget"
                          [showErrors]="showErrors"
                        ></app-social-element>
                      </div>

                      <div *ngIf="item.name === 'split-element'"
                           [hidden]="currentElement !== 'split-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-split-element
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [modelName]="item"
                          [typeClass]="typeClass"
                          [widthHrType]="widthHrType"
                        ></app-split-element>
                      </div>

                      <div *ngIf="item.name === 'title-element'"
                           [hidden]="currentElement !== 'title-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-text-element
                          [index]="i"
                          [item]="item"
                          [widget]="widget"
                        ></app-text-element>
                      </div>

                      <div *ngIf="item.name === 'video-element'"
                           [hidden]="currentElement !== 'video-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-video-element
                          (getVideo)="getVideoId($event)"
                          (setVideoSize)="newVideoSize($event, true)"
                          [floatBtn]="floatBtn"
                          [index]="i"
                          [modelName]="item"
                          [widthHrType]="widthHrType"
                        ></app-video-element>
                      </div>

                      <div *ngIf="item.name === 'timer-element'"
                           [hidden]="currentElement !== 'timer-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-timer-element
                          [index]="i"
                          [item]="item"
                          [widget]="widget"
                          [showErrors]="showErrors"
                        ></app-timer-element>
                      </div>

                      <div *ngIf="item.name === 'form-ext-element'"
                           [hidden]="currentElement !== 'form-ext-element' + (item.counter ? ('#' + item.counter) : '')">
                        <app-form-extended
                          (setExtended)="setExtended($event)"
                          [coupons]="coupons"
                          [index]="i"
                          [placePopup]="placePopup"
                          [widget]="widget"
                          [showErrors]="showErrors"
                        ></app-form-extended>
                      </div>
                    </div>

                    <app-elements-add
                      (addElement)="addElemFromWidget = 0; showAddedElement()"
                      [addElemFromWidget]="0"
                      [controls]="controls"
                      [floatBtn]="floatBtn"
                      [globalCouponObject]="globalCouponObject"
                      [hidden]="currentElement !== 'add-element'"
                      [isContainerized]="isContainerized"
                      [isPayment]="isPayment"
                      [sid]="sid"
                      [systemFonts]="systemFonts"
                      [typeClass]="typeClass"
                      [widget]="widget"
                      [widgwidthBtn]="widgwidthBtn"
                      [widthHrType]="widthHrType"
                    ></app-elements-add>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="elements-extended">
          <ng-container *ngIf="extendedElement">
            <div class="menu-fixed">
              <h4 class="panel-title d-flex justify-content-between mr-3">
                <a
                  (click)="backToRegularElement()"
                  class="back-regular-element mr-3"
                  href="javascript:void(0);"
                >
                  <i class="fas fa-arrow-left"></i>
                </a>
                <span>{{ extendedElement.label }}</span>
              </h4>
            </div>
            <div class="extended-container pt-3">
              <div class="border-item">
                <label class="control-label control-label-des switcher-label-xs mb-1">
                  {{ 'widgets.formExt.element' | translate }}
                </label>
                <ng-container *ngIf="extendedElement.type === 'email'">
                  <app-extended-text [hasPlaceholder]="true" [index]="extendedIndex"
                                     [item]="extendedElement"></app-extended-text>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'name'">
                  <app-extended-text [hasPlaceholder]="true" [index]="extendedIndex"
                                     [item]="extendedElement"></app-extended-text>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'message'">
                  <app-extended-text [hasPlaceholder]="true" [index]="extendedIndex"
                                     [item]="extendedElement"></app-extended-text>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'phone'">
                  <app-extended-text [hasPhoneBlock]="true" [hasPlaceholder]="true" [index]="extendedIndex"
                                     [item]="extendedElement"></app-extended-text>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'text'">
                  <app-extended-text [hasMultiline]="true" [hasPlaceholder]="true" [idEditable]="true"
                                     [index]="extendedIndex" [item]="extendedElement"></app-extended-text>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'rating'">
                  <app-extended-text [hasRating]="true" [hasSendForm]="true" [idEditable]="true"
                                     [index]="extendedIndex" [item]="extendedElement"></app-extended-text>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'variants'">
                  <app-extended-variants [index]="extendedIndex" [item]="extendedElement"></app-extended-variants>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'dd'">
                  <app-extended-dd [index]="extendedIndex" [item]="extendedElement"></app-extended-dd>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'date'">
                  <app-extended-text [hasDateBlock]="true" [hasPlaceholder]="true" [idEditable]="true"
                                     [index]="extendedIndex" [item]="extendedElement"></app-extended-text>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'title'">
                  <app-extended-title [index]="extendedIndex" [item]="extendedElement"></app-extended-title>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'term'">
                  <app-extended-title [index]="extendedIndex" [isTerm]="true"
                                      [item]="extendedElement"></app-extended-title>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'button'">
                  <app-extended-button [containerId]="widget.containerId" [index]="extendedIndex"
                                       [item]="extendedElement" [showErrors]="showErrors"></app-extended-button>
                </ng-container>
                <ng-container *ngIf="extendedElement.type === 'hidden'">
                  <app-extended-hidden [index]="extendedIndex" [item]="extendedElement"
                                       [showErrors]="showErrors"></app-extended-hidden>
                </ng-container>
              </div>

              <div *ngIf="this.widget.guiprops.formExt.model.list.length > 1" class="mt-3">
                <button
                  (click)="removeElementFromFormExtList($event, extendedIndex); $event.stopPropagation();"
                  class="btn-default extended-remove-btn"
                >
                  <i class="remove-item"></i> Удалить элемент
                </button>
              </div>
              <div class="mb-5"></div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
    <div class="col-lg-9 main-frame">
      <div class="widget-select-mode btn-group">
        <button
          (click)="$event.stopPropagation(); currentPage = 'main'"
          [class.active]="currentPage === 'main'"
          class="frame-button"
          data-widget="mainBlockWidget"
        >
          Основной экран
          <!--<i class="fas fa-ellipsis-v"></i>-->
        </button>
        <ng-container *ngIf="isThankShow">
          <div class="angle">
            <i class="fas fa-angle-right"></i>
          </div>
          <button
            (click)="$event.stopPropagation(); currentPage = 'thank'"
            [class.active]="currentPage === 'thank'"
            class="frame-button"
            data-container="body"
            data-original-title="Сообщение, которое видит посетитель после отправки формы."
            data-placement="top"
            data-toggle="tooltip"
            data-widget="thankWidget"
            title=""
          >
            Страница благодарности
            <!--<i class="fas fa-ellipsis-v"></i>-->
          </button>
        </ng-container>
      </div>
      <div [ngClass]="(widget.guiprops.popupMain?.shadow?.enable === true) ? 'ifr-sh-bg' : ''" class="max-h-100">
        <div
          *ngIf="widgetType === 'label_widget'"
          [ngClass]="wvLabelPos()"
          [ngStyle]="{'background': widget.guiprops['labelMain'].rgbaLabel, 'border-radius': widget.guiprops['labelMain'].borderRadiusLabel + 'px', 'z-index': '120'}"
          id="labelMain"
        >
          <div class="lab-content">
            <div
              *ngIf="widget.guiprops['labelMain'].iconOrImage === 'useImg'"
              [style.background-image]="'url(' + widget.guiprops['labelMain'].url + ')'"
              class="lgiconfontImg"
            ></div>
            <span
              [ngStyle]="{'font-family': widget.guiprops['labelMain'].font.fontFamily, 'font-size': widget.guiprops['labelMain'].fontSize + 'px', 'color': widget.guiprops['labelMain'].colorText}"
              class="label-text-with-add"
            >
              <i
                *ngIf="widget.guiprops['labelMain'].iconOrImage === 'useIcon' && !widget.guiprops['labelMain'].icon?.selectedIcon?.includes('fa ')"
                [class]="'lgiconfont-' + widget.guiprops['labelMain'].icon.selectIcon + ' flabels'"
                [ngStyle]="{'color': widget.guiprops['labelMain'].icon.color}"
              ></i>
              <i
                *ngIf="widget.guiprops['labelMain'].iconOrImage === 'useIcon' && widget.guiprops['labelMain'].icon?.selectedIcon?.includes('fa ')"
                [class]="widget.guiprops['labelMain'].icon.selectedIcon + ' font-awe'"
                [ngStyle]="{'color': widget.guiprops['labelMain'].icon.color}"
              ></i>
              {{ widget.guiprops.labelMain.text }}
            </span>
          </div>
        </div>

        <div
          (click)="scrollToEl('main-w-element', 'MainSetBl')"
          [ngStyle]="{'background': this.widget.guiprops.popupMain.shadow.enable ? widget.guiprops['popupMain']?.shadow.rgbaColor : 'none'}"
          class="max-wh-over"
        >
          <div class="popup-shadow popup-sh-pad">
            <div class="max-h-1001">
              <div [class.mobile]="currentDevice === 'mobile'" class="widget-visual-block">
                <div *ngIf="!(disElementOrNotBtnCloseLink())" class="close-btn-x">
                  <span></span>
                </div>
                <div class="clearfix"></div>
                <app-content-element
                  (addNewElement)="addNewElementToContent($event)"
                  (removeElement)="removeCurrentElement($event.element, $event.index)"
                  (scrollToElement)="scrollToEl($event.element, $event.index, $event.elementCounter)"
                  (updateElementIndex)="updateIndex($event)"
                  [bgStyle]="bgStyle"
                  [heightContentStyle]="heightContentStyle"
                  [heightImageStyle]="heightImageStyle"
                  [hidden]="currentPage !== 'main'"
                  [isMobile]="currentDevice === 'mobile'"
                  [widget]="widget"
                  [widthContentStyle]="widthContentStyle"
                  [widthImageStyle]="widthImageStyle"
                  style="display: block; width: max-content"
                ></app-content-element>
                <app-thank-element
                  [bgStyle]="bgStyle"
                  [hidden]="currentPage !== 'thank'"
                  [widget]="widget"
                ></app-thank-element>

                <div *ngIf="widgetType === 'optindot'" [ngClass]="wvBdLeft()" class="widget-visual-block-dot">
                  <div class="widget2-main-bl">
                    <div *ngIf="widget.guiprops['dhVisual'].enable && currentDevice !== 'mobile'"
                         class="widget2-plashka">
                      <span>{{ widget.guiprops.dhVisual.title }}</span>
                    </div>
                    <div
                      *ngIf="!widget.guiprops['dhVisual'].enableBlink"
                      [style]="'color: ' + widget.guiprops['dhVisual'].rgbaShadowForm1"
                      class="point__signal first"
                    ></div>
                    <div
                      *ngIf="!widget.guiprops['dhVisual'].enableBlink"
                      [style]="'color: ' + widget.guiprops['dhVisual'].rgbaShadowForm2"
                      class="point__signal second"
                    ></div>
                    <div
                      *ngIf="!widget.guiprops['dhVisual'].enableBlink"
                      [style]="'color: ' + widget.guiprops['dhVisual'].rgbaShadowForm2"
                      class="point__signal third"
                    ></div>
                    <div
                      [class.widget-dot-anim]="!widget.guiprops['dhVisual'].enableBlink"
                      [style]="'background: ' + widget.guiprops['dhVisual'].colorMain"
                      class="widget2"
                    >
                      <i
                        *ngIf="widget.guiprops['dhVisual'].iconOrImage === 'useIcon'"
                        [class.ico-anim]="!widget.guiprops['dhVisual'].enableBlink"
                        [class]="widget.guiprops.dhVisual.selectedIcon?.includes('fa ') ? widget.guiprops.dhVisual.selectedIcon : ('lgiconfont-' + widget.guiprops.dhVisual.selectIcon)"
                        [style]="'color: ' + widget.guiprops['dhVisual'].colorBg"
                        class="f30s"
                      ></i>
                      <div
                        *ngIf="widget.guiprops['dhVisual'].iconOrImage === 'useImg'"
                        [class.ico-anim]="!widget.guiprops['dhVisual'].enableBlink"
                        [style]="'background-image: url(' + widget.guiprops['dhVisual'].url + ')'"
                        class="lg-wg-dot-circle-img"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div aria-hidden="true" class="modal fade" id="addNewElementListModal" role="dialog" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header justify-content-center">
          <h4>Добавить элемент</h4>
          <button (click)="addElementModalHide()" aria-label="Close" class="close" data-dismiss="modal" type="button">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <app-elements-add
            (addElement)="showAddedElement()"
            [addElemFromWidget]="addElemFromWidget"
            [controls]="controls"
            [floatBtn]="floatBtn"
            [globalCouponObject]="globalCouponObject"
            [isContainerized]="isContainerized"
            [isPayment]="isPayment"
            [sid]="sid"
            [systemFonts]="systemFonts"
            [typeClass]="typeClass"
            [widget]="widget"
            [widgwidthBtn]="widgwidthBtn"
            [widthHrType]="widthHrType"
          ></app-elements-add>
        </div>
      </div>
    </div>
  </div>

  <ng-container #flowBasic="flow" [flowConfig]="{singleFile: true}"></ng-container>

  <div
    aria-hidden="true"
    class="modal fade"
    id="addNewWidgetListModal"
    role="dialog"
    tabindex="-1"
  >
    <div class="modal-dialog">
      <div class="dragAndDropFilter"></div>
      <div class="modal-content">
        <div class="modal-header justify-content-center">
          <h4>Мои изображения</h4>
          <button (click)="closeModalImg()" aria-label="Close" class="close" data-dismiss="modal" type="button">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h4 class="f-2">Загруженные изображения</h4>
          <div class="row row-nomargined">
            <div class="col-lg-12 mt-2" id="listImagesBlock"></div>
          </div>
        </div>
        <div class="modal-footer p-0 flex-column">
          <div class="img-set-foot1">
            <div [flow]="flowBasic.flowJs" class="dragDropBl drop-area" flowDrop>
              <div class="upload-drag-icon"><i class="fa fa-upload"></i></div>
              <button
                [flow]="flowBasic.flowJs"
                [ladda]="isLoading"
                class="load-img-gal btn btn-success ladda-button"
                data-style="slide-down"
                flowButton
              >
                <span class="ladda-label">Загрузить изображение</span>
              </button>

              <span class="dragOr">или перетащите изображение сюда</span>
            </div>
          </div>
          <div class="d-flex justify-content-between w-100 p-2 pl-4 pr-4">
            <button
              (click)="closeModalImg()"
              class="btn btn-default pull-left"
              data-dismiss="modal"
              id="btnCloseImgM"
              type="button"
            >
              Отмена
            </button>
            <button (click)="updateFile()" class="btn btn-info set-img-gal">Установить изображение</button>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
