<div class="widgets-settings-container" id="widgetStyle">

  <div class="row" style="height: 100%; overflow:hidden">
    <div class="col-lg-4 widget-style-menu">
      <div class="menu-fixed">
        <div class="menu-fixed-bg">
          <h4 class="panel-title" id="menu-select">
            Настройки виджета
          </h4>
        </div>
      </div>
      <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
        <div id="disabledFuncAct" class="hide"></div>
        <div id="accordionIn">

          <div class="panel panel-default" id="0">
            <div class="panel-heading" role="tab" id="headingFour">
              <h4 class="panel-title" data-detect="НАСТРОЙКИ ВИДЖЕТА">
                Настройки виджета
              </h4>
            </div>
            <div id="collapseFour" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFour">
              <div class="panel-body">
                <div class="border-item">
                  <div class="row row-subitem m-b-sm">
                    <div class="col-sm-12 row-subitem-padding">
                      <h3 class="marg-minus-bord-des">Расположение</h3>
                    </div>
                  </div>
                  <div class="row row-subitem">
                    <div class="col-sm-12 row-subitem-padding m-t-sm">
                      <label class="control-label control-label-des">Где показывать всплывающее окно:</label>
                      <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="true">
                          {{ widget.guiprops.popupMain.place }}
                          <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu dropd-scroll-sm" role="menu">
                          <li
                            role="presentation"
                            *ngFor="let item of placePopup"
                            (click)="widget.guiprops.popupMain.place = item"
                          >
                            <a role="menuitem" tabindex="-1" href="javascript:void(0)">{{ item }}</a>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="border-item">
                  <div class="row row-subitem m-b-md">
                    <div class="col-sm-12 row-subitem-padding">
                      <h3 class="marg-minus-bord-des">Маска</h3>
                    </div>
                  </div>
                  <div class="row row-subitem m-t-xs">
                    <div class="col-sm-12 row-subitem-padding padding-top-5">
                      <ui-switch
                        size="small"
                        [checked]="widget.guiprops.popupMain.shadow.enable"
                      ></ui-switch><label class="control-label switcher-label-xs control-label-des">Затемнять фон маской при показе виджета</label>
                    </div>
                  </div>
                  <div *ngIf="widget.guiprops['popupMain'].shadow.enable == true">
                    <div class="row row-subitem">
                      <div class="col-sm-6 row-subitem-padding padding-top-5">
                        <label class="control-label control-label-colorpc control-label-des">Цвет маски:</label>
                        <input
                          [(colorPicker)]="widget.guiprops['popupMain'].shadow.color"
                          [style.background]="widget.guiprops['popupMain'].shadow.color"
                          [cpAlphaChannel]="'disabled'"
                          [cpOutputFormat]="'hex'"
                        />
                      </div>
                      <div class="col-sm-6 row-subitem-padding padding-top-5 side-ui-dev">
                        <label class="control-label control-label-colorpc control-label-des">Прозрачность:</label>
                        <ngx-slider [(value)]="widget.guiprops['popupMain'].shadow.opacityColor" [options]="optionsOpacity"></ngx-slider>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row padding-left-10 margined-top-15">
                  <div class="col-sm-12 row-subitem-padding">
                    <h3 class="marg-minus-bord-des">Настройка дизайна виджета</h3>
                  </div>
                </div>
                <app-visual-element></app-visual-element>
                <app-redirect-element></app-redirect-element>
              </div>
            </div>
          </div>


          <div class="panel panel-default" id="1">
            <div class="panel-heading" role="tab" id="headingTwo">
              <h4 class="panel-title" data-detect="НАСТРОЙКИ ЭЛЕМЕНТОВ">
                Настройки элементов
              </h4>
            </div>
            <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingTwo">
              <div class="panel-body">

                <div class="row row-subitem m-b-sm m-t-md">
                  <div class="col-sm-12 row-subitem-padding">
                    <h3 class="marg-minus-bord">
                      Содержимое виджета<a
                      data-toggle="tooltip"
                      data-placement="right"
                      data-container="body"
                      title=""
                      class="info-link info-link-wd"
                      href="#"
                      data-original-title="Вы можете включать и отключать различные элементы, в зависимости от того, какой виджет вы хотите создать."
                    ><i class="fa fa-info-circle"></i></a>
                    </h3>
                  </div>
                </div>
                <div *ngFor="let item of widget.guiprops.elementsList; trackBy: trackById; index as i" [id]="'elemScrN' + i">
                  <div *ngIf="item.name === 'title-element'">
                    <app-text-element item="item" index="$index"></app-text-element>
                  </div>
                  <div *ngIf="item.name === 'video-element'">
                    <app-video-element [ngModel]="item"></app-video-element>
                  </div>
                  <div *ngIf="item.name === 'image-element'">
                    <app-image-element [ngModel]="item"></app-image-element>
                  </div>
                  <div *ngIf="item.name === 'iframe-element'">
                    <app-iframe-element [ngModel]="item"></app-iframe-element>
                  </div>
                  <div *ngIf="item.name === 'padding-element'">
                    <app-padding-element [ngModel]="item"></app-padding-element>
                  </div>
                  <div *ngIf="item.name === 'split-element'">
                    <app-split-element [ngModel]="item"></app-split-element>
                  </div>
                  <div *ngIf="item.name === 'coupon-element'">
                    <app-coupon-element item="item" coupons="coupons" [index]="i"></app-coupon-element>
                  </div>
                  <div *ngIf="item.name === 'form-element'">
                    <app-form-element></app-form-element>
                  </div>
                  <div *ngIf="item.name === 'form-ext-element'">
                    <app-form-extended-directive [ngModel]="item"></app-form-extended-directive>
                  </div>
                  <div *ngIf="item.name === 'closelink-element'">
                    <app-closelink-element></app-closelink-element>
                  </div>
                  <div *ngIf="item.name === 'button-element'">
                    <app-button-element
                      [widget]="widget"
                      [index]="i"
                      (removeElement)="removeElementFromElementsList($event.index, $event.elem)"
                    ></app-button-element>
                  </div>
                  <div *ngIf="item.name === 'social-element'">
                    <app-social-element></app-social-element>
                  </div>
                </div>
                <div>
                  <div class="widget-content-add">
                    <button
                      class="btn-default widget-content-add-btn"
                      (click)="addNewElementToContent()"
                    >
                      <i class="fa fa-plus"></i>Добавить новый элемент
                    </button>
                    <span>Для добавления элемента нажмите на эту кнопку и выберите элемент из списка</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    <div class="col-lg-8 max-h-100" ng-class="(widget.guiprops.popupMain.shadow.enable === true)?'ifr-sh-bg':''">
      <div class="widget-select-mode btn-group" ng-show="isThankShouldShow()">
        <span class="btn btn-default active" data-widget="mainBlockWidget" ng-click="calcWidthThank(); $event.stopPropagation();">Основной экран</span>
        <span class="btn btn-default" data-widget="thankWidget" ng-click="calcWidthThank(); $event.stopPropagation();" data-toggle="tooltip" data-placement="top" data-container="body" title="" data-original-title="Сообщение, которое видит посетитель после совершения целевого действия. Ваше сообщение благодарности будет показано посетителю, если в виджете отключена ссылка на LeadGenic, отключить ссылку можно в настройках сайта. В случае, если ссылка включена, посетителю будет показано сообщение благодарности LeadGenic.">Сообщение благодарности</span>
      </div>
      <div ng-click="scrollToEl('MainSetBl', 'main-w-element')" class="max-wh-over" ng-style="{'background':widget.guiprops['popupMain'].shadow.rgbaColor}">
        <div class="popup-shadow popup-sh-pad">
          <div class="max-h-1001">
            <div class="widget-visual-block" ng-style="{'width':'auto'}" ng-class="wvBLeft()">
              <div ng-show="!(disElementOrNotBtnCloseLink())" class="close-btn-x">
                <span></span>
              </div>
              <div class="clearfix"></div>
              <content-element></content-element>
              <thank-element></thank-element>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <app-content-element [widget]="widget"></app-content-element>

  <div class="footer-group">
    <div class="text-right padding10">
      <button
        type="button"
        *ngIf="widget.abtestInfo && (widget.abtestInfo.type === 'VARIANT')"
        (click)="goToTest(widget)"
        class="btn w-xs gototest-widget-btn"
      >
        <i class="pe-7s-back margined-right-5"></i> Перейти к A/B тесту
      </button>
      <a
        type="button"
        *ngIf="(!isMockup && widget.abtestInfo && (widget.abtestInfo.type !== 'VARIANT')) || (!isMockup && !widget.abtestInfo)"
        class="btn w-xs btn-primary buy-widget-btn"
      >
        <i class="pe-7s-tools margined-right-10"></i> {{ 'widgetsList.add.alt2' | translate }}
      </a>
      <div class="btn-group play-btns" *ngIf="!isMockup">
        <p>Статус:</p>
        <button
          *ngIf="(widget.abtestInfo && (widget.abtestInfo.type !== 'VARIANT')) || (!widget.abtestInfo)"
          (click)="startWidget(widget)"
          [ngClass]="(widget.active) ? 'active' : ''"
          class="btn btn-xs btn-default start-widget-btn"
          data-container="body" data-toggle="tooltip" data-placement="top" title="" data-original-title="Запустить виджет"
        >
          <i class="fa fa-play"></i>
        </button>
        <button
          *ngIf="(widget.abtestInfo && (widget.abtestInfo.type !== 'VARIANT')) || (!widget.abtestInfo)"
          (click)="stopWidget(widget)"
          [ngClass]="(widget.active) ? '' : 'active'"
          class="btn btn-xs btn-default stop-widget-btn"
          data-container="body" data-toggle="tooltip" data-placement="top" title="" data-original-title="Остановить виджет"
        >
          <i class="fa fa-pause"></i>
        </button>

        <button
          *ngIf="widget.abtestInfo && (widget.abtestInfo.type === 'VARIANT')"
          (click)="startWidget(widget)"
          [ngClass]="(widget.active) ? 'active' : ''"
          class="btn btn-xs btn-default start-widget-btn"
          data-container="body" data-toggle="tooltip" data-placement="top" title="" data-original-title="Запустить вариант"
        >
          <i class="fa fa-play"></i>
        </button>
        <button
          *ngIf="widget.abtestInfo && (widget.abtestInfo.type === 'VARIANT')"
          (click)="stopWidget(widget)"
          [ngClass]="(widget.active) ? '' : 'active'"
          class="btn btn-xs btn-default stop-widget-btn"
          data-container="body" data-toggle="tooltip" data-placement="top" title="" data-original-title="Остановить вариант"
        >
          <i class="fa fa-pause"></i>
        </button>
      </div>

      <ng-container *ngIf="isDesigner">
        <button
          type="button"
          *ngIf="!isMockup"
          (click)="saveAsMockup()"
          class="saveAsMockupBtn ladda-button btn w-xs btn-primary floated-left"
          data-style="slide-down"
        >
          <span class="ladda-label"><i class="fa fa-save"></i>Сохранить темплейт</span>
        </button>
      </ng-container>

      <button type="button" id="saveWidget" (click)="saveWidget()" class="ladda-button btn w-xs btn-success" data-style="slide-down">
        <span class="ladda-label">
          <i class="fa fa-save"></i> <span
          *ngIf="!isMockup"
          [innerHTML]="(widget.abtestInfo && (widget.abtestInfo.type === 'VARIANT')) ? 'Сохранить вариант' : 'Сохранить виджет'"></span><span
          *ngIf="isMockup">Сохранить темплейт</span>
        </span>
      </button>
    </div>
  </div>

  <div class="modal fade" id="addNewElementListModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="color-line"></div>
        <div class="modal-header text-center">
          <h4>Выберите элемент, который хотите добавить</h4>
        </div>

        <div class="modal-body">
          <div class="row-panel-fl">
            <div class="row-panel-item small-pdn">
              <div
                class="newElementItem"
                (click)="addFormExtButtonElement(disElementOrNotBtn())"
                [ngClass]="(disElementOrNotBtn()) ? 'disable-new-element-btn' : ''"
              >
                <div class="element-form-new-icon"></div>
                <span>Форма+кнопки (новый)</span>
              </div>
            </div>
            <div class="row-panel-item small-pdn">
              <div
                class="newElementItem"
                (click)="addFormButtonElement(disElementOrNotBtn())"
                [ngClass]="(disElementOrNotBtn()) ? 'disable-new-element-btn' : ''"
              >
                <div class="element-form-icon"></div>
                <span>Форма (устаревший)</span>
              </div>
            </div>
            <div class="row-panel-item small-pdn" *ngIf="!isContainerized">
              <div
                class="newElementItem"
                (click)="addCloseLinkElement(disElementOrNotBtnCloseLink())"
                [ngClass]="(disElementOrNotBtnCloseLink()) ? 'disable-new-element-btn' : ''"
              >
                <div class="element-dismiss-icon"></div>
                <span class="m-r-n m-l-n">Ссылка/Кнопка закрытия</span>
              </div>
            </div>
            <div class="row-panel-item small-pdn">
              <div
                class="newElementItem"
                (click)="addButtonElement(disElementOrNotBtn())"
                [ngClass]="(disElementOrNotBtn()) ? 'disable-new-element-btn' : ''"
              >
                <div class="element-button-icon"></div>
                <span>Кнопка</span>
              </div>
            </div>

            <div class="row-panel-item small-pdn">
              <div class="newElementItem" (click)="addTextElement()">
                <div class="element-text-icon"></div>
                <span>Текст</span>
              </div>
            </div>
            <div class="row-panel-item small-pdn">
              <div
                class="newElementItem"
                (click)="addSocialElement(disElementOrNotBtnSocial())"
                [ngClass]="(disElementOrNotBtnSocial()) ? 'disable-new-element-btn' : ''"
              >
                <div class="element-social-icon"></div>
                <span>Социальные кнопки</span>
              </div>
            </div>
            <div class="row-panel-item small-pdn">
              <div class="newElementItem" (click)="addSplitElement()">
                <div class="element-divider-icon"></div>
                <span>Разделитель</span>
              </div>
            </div>

            <div class="row-panel-item small-pdn">
              <div class="newElementItem" (click)="addVideoElement()">
                <div class="element-video-icon"></div>
                <span>Видео</span>
              </div>
            </div>
            <div class="row-panel-item small-pdn">
              <div class="newElementItem" (click)="addImageElement()">
                <div class="element-image-icon"></div>
                <span>Изображение</span>
              </div>
            </div>
            <div class="row-panel-item small-pdn">
              <div class="newElementItem" (click)="addPaddingElement()">
                <div class="element-padding-icon"></div>
                <span>Отступ</span>
              </div>
            </div>

            <div class="row-panel-item small-pdn">
              <div class="newElementItem" (click)="addIframeElement()">
                <div class="element-iframe-icon"></div>
                <span>HTML / JS / Iframe</span>
              </div>
            </div>

            <div class="row-panel-item small-pdn">
              <div class="newElementItem" (click)="addCouponElement()">
                <span class="payment-modal-icon label label-warning tariff-info">окупаемый</span>
                <div class="element-coupon-icon"></div>
                <span>Купон</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-container #flowBasic="flow" [flowConfig]="{target: 'imagestore/' + sid}"></ng-container>

  <div
    class="modal fade"
    id="addNewWidgetListModal"
    tabindex="-1"
    role="dialog"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="dragAndDropFilter"></div>
      <div class="modal-content">
        <div class="color-line"></div>
        <div class="modal-header text-center">
          <h4 class="modal-title">Мои изображения</h4>
        </div>
        <div class="modal-body">
          <h4>Загруженные изображения</h4>
          <div class="row row-nomargined">
            <div id="listImagesBlock" class="col-lg-12 margined-top-10"></div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="img-set-foot1">
            <div class="dragDropBl">
              <div class="upload-drag-icon"><i class="fa fa-upload"></i></div>
              <button
                flowButton
                [flow]="flowBasic.flowJs"
                [flowAttributes]="{accept: 'image/*'}"
                [ladda]="isLoading"
                class="load-img-gal btn btn-success ladda-button"
                data-style="slide-down"
              >
                <span class="ladda-label">Загрузить изображение</span>
              </button>

              <div
                class="drop-area"
                flowDrop
                [flow]="flowBasic.flowJs"
              >
                <span class="dragOr">или перетащите изображение сюда</span>
              </div>
            </div>
          </div>
          <div>
            <button data-dismiss="modal" (click)="closeModalImg()" id="btnCloseImgM" class="btn btn-default pull-left" type="button">Отмена</button>
            <button class="btn btn-info set-img-gal" (click)="updateFile()">Установить изображение</button>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
